<?xml version="1.0" encoding="UTF-8"?>
<sbe:messageSchema xmlns:sbe="http://fixprotocol.io/2016/sbe"
  package="io.sye.sbe" id="1" version="0" semanticVersion="5.2"
  description="A schema represents stock market data.">
  <types>
    <!--    Common types-->
    <composite name="messageHeader">
      <type name="blockLength" primitiveType="uint16"/>
      <type name="templateId" primitiveType="uint16"/>
      <type name="schemaId" primitiveType="uint16"/>
      <type name="version" primitiveType="uint16"/>
    </composite>
    <composite name="groupSizeEncoding">
      <type name="blockLength" primitiveType="uint16"/>
      <type name="numInGroup" primitiveType="uint16"/>
    </composite>
    <enum name="BooleanType" encodingType="int8">
      <validValue name="FALSE">0</validValue>
      <validValue name="TRUE">1</validValue>
    </enum>
    <composite name="String">
      <type name="length" primitiveType="uint32" maxValue="1073741824"/>
      <type name="varData" primitiveType="uint8" length="0" characterEncoding="UTF-8"/>
    </composite>
    <!--    Custom types-->
    <enum name="Market" encodingType="int8">
      <validValue name="NYSE">0</validValue>
      <validValue name="NASDAQ">1</validValue>
    </enum>
    <type name="Symbol" primitiveType="char" length="6" characterEncoding="ASCII"
      description="Stock symbol"/>
    <composite name="BigDecimal">
      <type name="value" primitiveType="int64" minValue="0"/>
      <type name="scale" primitiveType="int8"/>
    </composite>
    <enum name="Currency" encodingType="uint8">
      <validValue name="USD" description="US Dollar">0</validValue>
      <validValue name="EUR" description="Euro">1</validValue>
    </enum>
    <composite name="BidAsk">
      <ref name="price" type="BigDecimal"/>
      <type name="size" primitiveType="int64"/>
      <type name="orderCount" primitiveType="int32"/>
    </composite>
    <composite name="Quote"
      description="A quote represents the price of a stock in a market">
      <ref name="market" type="Market"/>
      <ref name="symbol" type="Symbol"/>
      <ref name="price" type="BigDecimal"/>
      <ref name="currency" type="Currency"/>
    </composite>
  </types>

  <sbe:message name="TradeData" id="1">
    <field name="quote" id="1" type="Quote"/>
    <field name="amount" id="2" type="BigDecimal"/>
  </sbe:message>
  <sbe:message name="OrderBookUpdate" id="2">
    <field name="id" id="1" type="int64"/>
    <field name="symbol" id="2" type="Symbol"/>
    <field name="timestamp" id="3" type="int64"/>
    <group name="bids" id="4">
      <field name="bid" id="5" type="BidAsk"/>
    </group>
    <group name="asks" id="6">
      <field name="ask" id="7" type="BidAsk"/>
    </group>
  </sbe:message>
</sbe:messageSchema>